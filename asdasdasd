-- anti bee
local player = game.Players.LocalPlayer
local RS   = game:GetService("RunService")
local UIS  = game:GetService("UserInputService")
local Http = game:GetService("HttpService")
local Workspace = game:GetService("Workspace")

task.spawn(function()
    pcall(function()
        repeat task.wait() until player and player:FindFirstChild("PlayerGui") and Workspace
        task.wait(0.3)

        -- CONFIG
        local CONFIG_FILE = "MiniHub_Config.json"
        local CONFIG = { keybinds = {}, states = {} }
        local function loadConfig()
            if isfile and readfile and isfile(CONFIG_FILE) then
                local ok, data = pcall(function() return Http:JSONDecode(readfile(CONFIG_FILE)) end)
                if ok and data then CONFIG = data end
            end
        end
        local function saveConfig()
            if writefile then pcall(function() writefile(CONFIG_FILE, Http:JSONEncode(CONFIG)) end) end
        end
        loadConfig()

        -- GUI
        local gui = Instance.new("ScreenGui")
        gui.Name = "MiniHub"
        gui.ResetOnSpawn = false
        gui.Parent = player.PlayerGui

        local window = Instance.new("Frame")
        window.Size = UDim2.new(0, 280, 0, 600)
        window.Position = UDim2.new(0, 10, 0.5, -300)
        window.BackgroundColor3 = Color3.fromRGB(25,25,25)
        window.Active = true
        window.Draggable = true
        window.ClipsDescendants = true
        window.Parent = gui
        local corner = Instance.new("UICorner", window); corner.CornerRadius = UDim.new(0, 12)

        local title = Instance.new("TextButton")
        title.Size = UDim2.new(1, -10, 0, 30)
        title.Position = UDim2.new(0, 5, 0, 5)
        title.BackgroundTransparency = 1
        title.Text = "MINI HUB Down Arrow"
        title.TextColor3 = Color3.new(1,1,1)
        title.Font = Enum.Font.GothamBold
        title.TextSize = 16
        title.Parent = window

        local close = Instance.new("TextButton")
        close.Size = UDim2.new(0, 25, 0, 25)
        close.Position = UDim2.new(1, -33, 0, 8)
        close.BackgroundColor3 = Color3.fromRGB(220,50,50)
        close.Text = "X"
        close.TextColor3 = Color3.new(1,1,1)
        close.Font = Enum.Font.GothamBold
        close.TextSize = 16
        close.Parent = window
        local closeCorner = Instance.new("UICorner", close); closeCorner.CornerRadius = UDim.new(0, 6)

        local saveBtn = Instance.new("TextButton")
        saveBtn.Size = UDim2.new(1, -20, 0, 35)
        saveBtn.Position = UDim2.new(0, 10, 1, -45)
        saveBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
        saveBtn.Text = "SAVE CONFIG"
        saveBtn.TextColor3 = Color3.new(1,1,1)
        saveBtn.Font = Enum.Font.GothamBold
        saveBtn.TextSize = 14
        saveBtn.Parent = window
        local saveCorner = Instance.new("UICorner", saveBtn); saveCorner.CornerRadius = UDim.new(0, 8)

        -- SCROLLING CONTAINER
        local scroll = Instance.new("ScrollingFrame")
        scroll.Size = UDim2.new(1, -20, 1, -90)
        scroll.Position = UDim2.new(0, 10, 0, 40)
        scroll.BackgroundTransparency = 1
        scroll.ScrollBarThickness = 6
        scroll.ScrollBarImageColor3 = Color3.fromRGB(100,100,100)
        scroll.CanvasSize = UDim2.new(0, 0, 0, 0) -- Auto
        scroll.Visible = true
        scroll.Parent = window

        local layout = Instance.new("UIListLayout")
        layout.SortOrder = Enum.SortOrder.LayoutOrder
        layout.Padding = UDim.new(0, 8)
        layout.Parent = scroll

        -- Auto resize canvas
        layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            scroll.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 20)
        end)

        local isOpen = true
        title.MouseButton1Click:Connect(function()
            isOpen = not isOpen
            title.Text = "MINI HUB " .. (isOpen and "Down Arrow" or "Right Arrow")
            scroll.Visible = isOpen
            saveBtn.Visible = isOpen
            window.Size = UDim2.new(0, 280, 0, isOpen and 600 or 40)
        end)

        close.MouseButton1Click:Connect(function()
            saveConfig()
            gui:Destroy()
        end)

        saveBtn.MouseButton1Click:Connect(function()
            saveConfig()
            saveBtn.Text = "SAVED!"
            task.delay(1, function() saveBtn.Text = "SAVE CONFIG" end)
        end)

        -- INPUT
        local bindingName, bindingKeyBox, buttons = nil, nil, {}
        UIS.InputBegan:Connect(function(inp, gp)
            if gp then return end
            local key = inp.KeyCode
            local keyName = key.Name
            if keyName == "Return" then keyName = "ENTER" end
            if keyName == "Space" then keyName = "SPACE" end

            if key == Enum.KeyCode.LeftAlt or key == Enum.KeyCode.RightAlt then
                if bindingName then
                    CONFIG.keybinds[bindingName] = nil
                    bindingKeyBox.Text = "NONE"
                    bindingKeyBox.TextColor3 = Color3.new(0.8,0.8,0.8)
                    bindingName, bindingKeyBox = nil, nil
                    saveConfig()
                end
                return
            end

            if bindingName then
                CONFIG.keybinds[bindingName] = keyName
                bindingKeyBox.Text = keyName
                bindingKeyBox.TextColor3 = Color3.new(0.8,0.8,0.8)
                bindingName, bindingKeyBox = nil, nil
                saveConfig()
                return
            end

            for name, data in pairs(CONFIG.keybinds) do
                if data == keyName then
                    local btnInfo = buttons[name]
                    if not btnInfo then continue end
                    local newState = not (CONFIG.states[name] or false)
                    CONFIG.states[name] = newState
                    btnInfo.btn.Text = name .. (newState and " [ON]" or " [OFF]")
                    btnInfo.btn.BackgroundColor3 = newState and btnInfo.on or btnInfo.off
                    btnInfo.callback(newState)
                    saveConfig()
                end
            end
        end)

        -- BUTTON FACTORY
        local OFF_COLOR = Color3.fromRGB(30,30,30)
        local ON_COLOR  = Color3.fromRGB(0,170,255)

        local function makeBtn(name, order, callback)
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(1,0,0,45)
            frame.BackgroundTransparency = 1
            frame.LayoutOrder = order
            frame.Parent = scroll

            local btn = Instance.new("TextButton")
            btn.Size = UDim2.new(0,190,1,0)
            btn.BackgroundColor3 = OFF_COLOR
            btn.Text = name.." [OFF]"
            btn.TextColor3 = Color3.new(1,1,1)
            btn.Font = Enum.Font.GothamBold
            btn.TextSize = 15
            btn.Parent = frame
            local btnCorner = Instance.new("UICorner", btn); btnCorner.CornerRadius = UDim.new(0, 10)

            local keyBox = Instance.new("TextButton")
            keyBox.Size = UDim2.new(0,60,1,0)
            keyBox.Position = UDim2.new(1,-65,0,0)
            keyBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
            keyBox.TextColor3 = Color3.new(0.8,0.8,0.8)
            keyBox.Font = Enum.Font.Gotham
            keyBox.TextSize = 13
            keyBox.Text = CONFIG.keybinds[name] or "NONE"
            keyBox.Parent = frame
            local keyCorner = Instance.new("UICorner", keyBox); keyCorner.CornerRadius = UDim.new(0, 8)

            keyBox.MouseButton1Click:Connect(function()
                bindingName = name
                bindingKeyBox = keyBox
                keyBox.Text = "PRESS KEY..."
                keyBox.TextColor3 = Color3.new(1,1,0)
            end)

local state = CONFIG.states[name] or false
btn.Text = name..(state and " [ON]" or " [OFF]")
btn.BackgroundColor3 = state and ON_COLOR or OFF_COLOR
if state then callback(true) end


            btn.MouseButton1Click:Connect(function()
                state = not state
                btn.Text = name..(state and " [ON]" or " [OFF]")
                btn.BackgroundColor3 = state and ON_COLOR or OFF_COLOR
                CONFIG.states[name] = state
                callback(state)
                saveConfig()
            end)

            buttons[name] = {btn=btn, keyBox=keyBox, off=OFF_COLOR, on=ON_COLOR, callback=callback}
        end

        -- =====================================================
        -- 6. STEAL FLOOR ￢ﾀﾓ FINAL
        -- =====================================================
        makeBtn("Steal Floor",110,function(state)
            if not state then
                if _G.stealFloor then
                    if _G.stealFloor.part then _G.stealFloor.part:Destroy() end
                    if _G.stealFloor.noclip then _G.stealFloor.noclip:Disconnect(); _G.stealFloor.noclip = nil end
                    if _G.stealFloor.promptConns then
                        for _, conn in pairs(_G.stealFloor.promptConns) do conn:Disconnect() end
                    end
                    _G.stealFloor = nil
                end
                return
            end

            local char = player.Character or player.CharacterAdded:Wait()
            local hrp = char:WaitForChild("HumanoidRootPart")
            local head = char:WaitForChild("Head")
            local upperTorso = char:FindFirstChild("UpperTorso")
            local hum = char:FindFirstChildOfClass("Humanoid")

            -- ONE-TIME COIL COMBO
            if not _G.stealFloor then
                local tool = player.Backpack:FindFirstChild("Coil Combo") or char:FindFirstChild("Coil Combo")
                if tool and hum then hum:EquipTool(tool) end
            end

            local platform = Instance.new("Part")
            platform.Size = Vector3.new(8, 1, 8)
            platform.CFrame = hrp.CFrame * CFrame.new(0, -3.5, 0)
            platform.Anchored = true
            platform.CanCollide = true
            platform.Transparency = 0.3
            platform.Material = Enum.Material.Neon
            platform.Color = Color3.fromHSV(0, 1, 1)
            platform.Parent = Workspace

            local hue = 0
            local riseSpeed = 15
            local locked = false

            _G.stealFloor = { part = platform, locked = locked, noclip = nil, promptConns = {} }

            RS.Heartbeat:Connect(function(dt)
                if not platform.Parent then return end
                hue = (hue + dt * 0.6) % 1
                platform.Color = Color3.fromHSV(hue, 1, 1)
            end)

            local floatConn = RS.Heartbeat:Connect(function(dt)
                if locked or not platform.Parent then return end
                local newY = platform.Position.Y + riseSpeed * dt
                platform.CFrame = CFrame.new(hrp.Position.X, newY, hrp.Position.Z)
            end)

            local touchConn = platform.Touched:Connect(function(part)
                if locked or not part.Parent then return end
                if part.Name == "LowerTorso" and part:IsDescendantOf(char) then
                    locked = true
                    platform.Transparency = 0.1
                    platform.Material = Enum.Material.ForceField
                    platform.Size = Vector3.new(platform.Size.X, platform.Size.Y * 0.7, platform.Size.Z)
                    platform.CFrame = platform.CFrame * CFrame.new(0, -platform.Size.Y * 0.15, 0)

                    _G.stealFloor.noclip = RS.Heartbeat:Connect(function()
                        if head and head.Parent then head.CanCollide = false end
                        if upperTorso and upperTorso.Parent then upperTorso.CanCollide = false end
                    end)

                    floatConn:Disconnect()
                end
            end)

            local function onPromptTriggered()
                if not _G.stealFloor then return end
                if platform and platform.Parent then platform:Destroy() end
                if _G.stealFloor.noclip then _G.stealFloor.noclip:Disconnect() end
                if touchConn then touchConn:Disconnect() end
                if floatConn then floatConn:Disconnect() end

                if hum and char:FindFirstChild("Coil Combo") then hum:UnequipTools() end

                local btnInfo = buttons["Steal Floor"]
                if btnInfo then
                    CONFIG.states["Steal Floor"] = false
                    btnInfo.btn.Text = "Steal Floor [OFF]"
                    btnInfo.btn.BackgroundColor3 = OFF_COLOR
                    saveConfig()
                end

                if _G.stealFloor.promptConns then
                    for _, conn in pairs(_G.stealFloor.promptConns) do conn:Disconnect() end
                end
                _G.stealFloor = nil
            end

            for _, obj in ipairs(Workspace:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then
                    table.insert(_G.stealFloor.promptConns, obj.Triggered:Connect(onPromptTriggered))
                end
            end

            table.insert(_G.stealFloor.promptConns, Workspace.DescendantAdded:Connect(function(obj)
                if obj:IsA("ProximityPrompt") then
                    table.insert(_G.stealFloor.promptConns, obj.Triggered:Connect(onPromptTriggered))
                end
            end))
        end)


makeBtn("Anti Bee", 160, function(state)
    local Lighting = game:GetService("Lighting")
    local UIS = game:GetService("UserInputService")
    local Camera = workspace.CurrentCamera
    local RS = game:GetService("RunService")
    local player = game.Players.LocalPlayer

    local function deleteBeeEffects()
        for _, name in ipairs({"BeeBlur", "ColorCorrection", "ColorCCorrection", "DiscoEffect", "Blur"}) do
            local obj = Lighting:FindFirstChild(name)
            if obj then obj:Destroy() end
        end
    end

    -- Disconnect previous connections
    if _G.antiBeeConn then _G.antiBeeConn:Disconnect() _G.antiBeeConn = nil end
    if _G.reverseConn then _G.reverseConn:Disconnect() _G.reverseConn = nil end
    if _G.fovWatcher then _G.fovWatcher:Disconnect() _G.fovWatcher = nil end

    if not state then return end

    -- Delete effects instantly and keep deleting new ones
    deleteBeeEffects()
    _G.antiBeeConn = Lighting.DescendantAdded:Connect(function(obj)
        if obj.Name == "BeeBlur" 
        or obj.Name == "ColorCorrection" 
        or obj.Name == "ColorCCorrection"
        or obj.Name == "DiscoEffect"
        or obj.Name == "Blur" then
            task.wait(0.05)
            obj:Destroy()
        end
    end)

    -- FOV watcher: always 70
    Camera.FieldOfView = 70
    _G.fovWatcher = RS.RenderStepped:Connect(function()
        if Camera.FieldOfView ~= 70 then
            Camera.FieldOfView = 70
        end
    end)

    -- Reverse movement (W<->S, A<->D)
    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:WaitForChild("Humanoid")

    _G.reverseConn = RS.RenderStepped:Connect(function()
        local moveDir = Vector3.zero
        if UIS:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir - Vector3.new(0,0,1) end
        if UIS:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir + Vector3.new(0,0,1) end
        if UIS:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - Vector3.new(1,0,0) end
        if UIS:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + Vector3.new(1,0,0) end

        if moveDir.Magnitude > 0 then hum:Move(moveDir, true) end
    end)
end)




        -- =====================================================
        -- 7. OTHER FEATURES
        -- =====================================================
 makeBtn("Auto Kick", 60, function(state)
    -- SAFE: Manual FindFirstChild checks
    local playerGui = player:FindFirstChild("PlayerGui")
    if not playerGui then return end

    local notifOuter = playerGui:FindFirstChild("Notification")
    if not notifOuter then return end

    local notifFolder = notifOuter:FindFirstChild("Notification")
    if not notifFolder then return end

    -- Clean old connection
    if _G.brainrotConn then
        _G.brainrotConn:Disconnect()
        _G.brainrotConn = nil
    end

    if not state then return end

    _G.brainrotConn = notifFolder.ChildAdded:Connect(function(child)
        if child:IsA("TextLabel") then
            task.wait(0.05)
            local text = child.Text or ""
            if text:match("^You stole") and text:find("<stroke") and text:find("<font") then
                player:Kick("Brainrot has been stolen.")
            end
        end
    end)
end)

-- === MINI HUB BUTTON ===
makeBtn("Flight", 80, function(state)
    local playerGui = player:FindFirstChild("PlayerGui")
    if not playerGui then return end

    local existingGUI = playerGui:FindFirstChild("SpeedHelperGUI")
    if not state then
        if existingGUI then
            existingGUI:Destroy()
        end
        return
    end

    if existingGUI then return end

    -- === FLIGHT GUI ===
    local gui = Instance.new("ScreenGui")
    gui.Name = "SpeedHelperGUI"
    gui.ResetOnSpawn = false
    gui.Parent = playerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 300, 0, 150)
    -- Fixed middle-left position
    frame.Position = UDim2.new(1, -10, 0.5, -75)
    frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    frame.Active = true
    frame.Draggable = true
    frame.Parent = gui
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

    -- Title
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 25)
    title.BackgroundTransparency = 1
    title.Text = "Speed Helper"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 16
    title.Parent = frame

    -- Flight Toggle Button
    local flying = false
    local flightConn
    local speed = CONFIG.FlightSpeed or 29
    local vertical = 65

    local function enableFlight()
        local char = player.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        local hum = char:FindFirstChild("Humanoid")
        if not hrp or not hum then return end

        hum.PlatformStand = false
        flightConn = RS.Heartbeat:Connect(function()
            if not hrp or not hum then return end
            local moveDir = hum.MoveDirection
            local vel = Vector3.new(moveDir.X * speed, 0, moveDir.Z * speed)
            if hum.Jump then
                vel += Vector3.new(0, vertical, 0)
            elseif UIS:IsKeyDown(Enum.KeyCode.LeftControl) then
                vel += Vector3.new(0, -vertical, 0)
            end
            hrp.Velocity = hrp.Velocity:Lerp(vel, 0.55)
        end)
    end

    local function disableFlight()
        if flightConn then
            flightConn:Disconnect()
            flightConn = nil
        end
        local char = player.Character
        if char and char:FindFirstChild("Humanoid") then
            char.Humanoid.PlatformStand = false
        end
    end

    local flightBtn = Instance.new("TextButton")
    flightBtn.Size = UDim2.new(1, -20, 0, 50)
    flightBtn.Position = UDim2.new(0, 10, 0, 35)
    flightBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    flightBtn.Text = "Toggle Flight ￰ﾟﾕﾊ￯ﾸﾏ [OFF]"
    flightBtn.TextColor3 = Color3.new(1, 1, 1)
    flightBtn.Font = Enum.Font.GothamBold
    flightBtn.TextSize = 18
    flightBtn.Parent = frame
    Instance.new("UICorner", flightBtn).CornerRadius = UDim.new(0, 12)

    -- Set initial state from config
    if CONFIG.states["Flight"] then
        flying = true
        enableFlight()
        flightBtn.Text = "Toggle Flight ￰ﾟﾕﾊ￯ﾸﾏ [ON]"
        flightBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    end

    flightBtn.MouseButton1Click:Connect(function()
        flying = not flying
        if flying then
            enableFlight()
            flightBtn.Text = "Toggle Flight ￰ﾟﾕﾊ￯ﾸﾏ [ON]"
            flightBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
        else
            disableFlight()
            flightBtn.Text = "Toggle Flight ￰ﾟﾕﾊ￯ﾸﾏ [OFF]"
            flightBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        end
        CONFIG.states["Flight"] = flying
        saveConfig()
    end)

    -- Slider
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Size = UDim2.new(1, -20, 0, 20)
    sliderFrame.Position = UDim2.new(0, 10, 0, 95)
    sliderFrame.BackgroundColor3 = Color3.fromRGB(60,60,60)
    sliderFrame.Parent = frame
    Instance.new("UICorner", sliderFrame).CornerRadius = UDim.new(0, 6)

    local sliderBar = Instance.new("Frame")
    sliderBar.Size = UDim2.new(speed/29, 0, 1, 0)
    sliderBar.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
    sliderBar.Parent = sliderFrame
    Instance.new("UICorner", sliderBar).CornerRadius = UDim.new(0, 6)

    local sliderLabel = Instance.new("TextLabel")
    sliderLabel.Size = UDim2.new(1, 0, 0, 20)
    sliderLabel.Position = UDim2.new(0, 0, 0, 25)
    sliderLabel.BackgroundTransparency = 1
    sliderLabel.Text = "Speed: " .. speed
    sliderLabel.TextColor3 = Color3.new(1,1,1)
    sliderLabel.Font = Enum.Font.Gotham
    sliderLabel.TextSize = 14
    sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
    sliderLabel.Parent = sliderFrame

    -- Dragging logic
    local dragging = false
    local function updateSlider(x)
        local framePos = sliderFrame.AbsolutePosition.X
        local frameSize = sliderFrame.AbsoluteSize.X
        local newVal = math.clamp((x - framePos) / frameSize, 0, 1) * 29
        speed = math.floor(newVal*100)/100
        sliderBar.Size = UDim2.new(speed/29, 0, 1, 0)
        sliderLabel.Text = "Speed: " .. tostring(speed)
        CONFIG.FlightSpeed = speed
        saveConfig()
    end

    sliderFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            updateSlider(input.Position.X)
            frame.Draggable = false
        end
    end)

    UIS.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            updateSlider(input.Position.X)
        end
    end)

    UIS.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
            frame.Draggable = true
        end
    end)
end)



        makeBtn("Jump Boost",55,function(state)
            if _G.jumpBoostConn then _G.jumpBoostConn:Disconnect(); _G.jumpBoostConn=nil end
            if not state then return end
            local char = player.Character or player.CharacterAdded:Wait()
            local hum = char:WaitForChild("Humanoid")
            local hrp = char:WaitForChild("HumanoidRootPart")
            _G.jumpBoostConn = RS.Heartbeat:Connect(function()
                if hum:GetState()==Enum.HumanoidStateType.Jumping then
                    hrp.AssemblyLinearVelocity += Vector3.new(0,17.375,0)
                end
            end)
        end)

 makeBtn("Glitched Slap",165,function(state)
    -- === FULL CLEANUP ===
    for _, v in pairs({"Conn","CharConn","BpAdd","BpRem"}) do
        if _G["gs"..v] then _G["gs"..v]:Disconnect(); _G["gs"..v]=nil end
    end

    -- === OFF: UNEQUIP + STOP ===
    if not state then
        local char = player.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum:UnequipTools() end
        end
        return
    end

    -- === ON: ALWAYS EQUIPPED ===
    local function equip()
        local char = player.Character
        local bp = player:FindFirstChild("Backpack")
        if not char or not bp then return end
        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hum then return end
        local tool = bp:FindFirstChild("Glitched Slap") or char:FindFirstChild("Glitched Slap")
        if tool and tool.Parent ~= char then
            hum:EquipTool(tool)
        end
    end

    _G.gsConn = RS.Heartbeat:Connect(function()
        if tick() - (_G.gsLast or 0) >= 0.4 then
            _G.gsLast = tick()
            equip()
        end
    end)

    _G.gsCharConn = player.CharacterAdded:Connect(function()
        task.wait(0.6)
        equip()
    end)

    local bp = player:FindFirstChild("Backpack")
    if bp then
        _G.gsBpAdd = bp.ChildAdded:Connect(equip)
        _G.gsBpRem = bp.ChildRemoved:Connect(equip)
    end

    equip()
end)

        makeBtn("Invis Cam",220,function(state)
            player.DevCameraOcclusionMode = state and Enum.DevCameraOcclusionMode.Invisicam or Enum.DevCameraOcclusionMode.Zoom
        end)

        makeBtn("Spin",275,function(state)
            local function stop()
                local char = player.Character
                if not char then return end
                local root = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
                if root then local s=root:FindFirstChild("Spinning"); if s then s:Destroy() end end
            end
            if not state then
                stop()
                if _G.spinRespawn then _G.spinRespawn:Disconnect(); _G.spinRespawn=nil end
                return
            end
            local SPEED = 20
            local function apply()
                local char = player.Character
                if not char then return end
                local root = char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
                if not root then return end
                local old = root:FindFirstChild("Spinning")
                if old then old:Destroy() end
                local spin = Instance.new("BodyAngularVelocity")
                spin.Name = "Spinning"
                spin.Parent = root
                spin.MaxTorque = Vector3.new(0,math.huge,0)
                spin.AngularVelocity = Vector3.new(0,SPEED,0)
            end
            apply()
            if _G.spinRespawn then _G.spinRespawn:Disconnect() end
            _G.spinRespawn = player.CharacterAdded:Connect(function()
                task.wait(0.1)
                if state then apply() end
            end)
        end)

        makeBtn("Flasher",330,function(state)
            if _G.flasherTrack then _G.flasherTrack:Stop(); _G.flasherTrack = nil end
            if _G.flasherConn then _G.flasherConn:Disconnect(); _G.flasherConn = nil end
            if not state then
                local char = player.Character
                if char then
                    local hum = char:FindFirstChildOfClass("Humanoid")
                    if hum then
                        for _, track in pairs(hum:GetPlayingAnimationTracks()) do track:Stop() end
                        hum:ChangeState(Enum.HumanoidStateType.Running)
                    end
                end
                return
            end
            local char = player.Character or player.CharacterAdded:Wait()
            local hum = char:WaitForChild("Humanoid")
            local animator = hum:FindFirstChildOfClass("Animator")
            local anim = Instance.new("Animation")
            anim.AnimationId = "rbxassetid://77840765435893"
            _G.flasherTrack = animator:LoadAnimation(anim)
            _G.flasherTrack.Priority = Enum.AnimationPriority.Core
            _G.flasherTrack:Play()
            _G.flasherConn = RS.Heartbeat:Connect(function()
                if not char or not char.Parent or hum.Health <= 0 then return end
                if not _G.flasherTrack.IsPlaying then _G.flasherTrack:Play() end
                for _, track in pairs(hum:GetPlayingAnimationTracks()) do
                    if track ~= _G.flasherTrack then track:Stop() end
                end
            end)
        end)

        makeBtn("Anti Lag/Anti Flash",385,function(state)
            if not state then
                if _G.antiLagConn then _G.antiLagConn:Disconnect(); _G.antiLagConn = nil end
                if _G.antiLagDescConn then _G.antiLagDescConn:Disconnect(); _G.antiLagDescConn = nil end
                return
            end
            local function stripHumanoid(hum)
                local char = hum.Parent
                if not char then return end
                for _, obj in ipairs(char:GetDescendants()) do
                    if obj:IsA("Accessory") or obj:IsA("LayeredClothing") or obj:IsA("Clothing") then
                        pcall(function() obj:Destroy() end)
                    end
                end
            end
            local function stripAll()
                for _, obj in ipairs(workspace:GetDescendants()) do
                    if obj:IsA("Humanoid") then stripHumanoid(obj) end
                end
            end
            stripAll()
            _G.antiLagDescConn = workspace.DescendantAdded:Connect(function(obj)
                if obj:IsA("Humanoid") then task.wait(0.5); stripHumanoid(obj)
                elseif (obj:IsA("Accessory") or obj:IsA("LayeredClothing")) and obj.Parent and obj.Parent:FindFirstChildOfClass("Humanoid") then
                    task.delay(0.1, function() pcall(function() obj:Destroy() end) end)
                end
            end)
            _G.antiLagConn = player.CharacterAdded:Connect(function()
                task.wait(1); stripAll()
            end)
        end)

makeBtn("Anti Ragdoll", 1, function(state)
    -- Cleanup
    if _G.afRemoteConn then _G.afRemoteConn:Disconnect() end
    if _G.afStateConn then _G.afStateConn:Disconnect() end
    if _G.afInputConn then _G.afInputConn:Disconnect() end
    if _G.afVelocity then _G.afVelocity:Destroy() end
    _G.afRemoteConn, _G.afStateConn, _G.afInputConn, _G.afVelocity = nil, nil, nil, nil

    -- Restore physics
    if not state and _G.originalPhysicalProps then
        for part, props in pairs(_G.originalPhysicalProps) do
            if part and part.Parent then
                pcall(function() part.CustomPhysicalProperties = props end)
            end
        end
        _G.originalPhysicalProps = nil
    end

    if not state then return end

    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:WaitForChild("Humanoid")
    local torso = char:FindFirstChild("UpperTorso") or char:WaitForChild("HumanoidRootPart")
    local RagdollRemote = game.ReplicatedStorage.Packages.Ragdoll.Ragdoll

    -- Save physics
    if not _G.originalPhysicalProps then
        _G.originalPhysicalProps = {}
        for _, part in ipairs(char:GetChildren()) do
            if part:IsA("BasePart") then
                _G.originalPhysicalProps[part] = part.CustomPhysicalProperties
            end
        end
    end

    -- Dense physics (anti-fling)
    for _, part in ipairs(char:GetChildren()) do
        if part:IsA("BasePart") then
            part.CustomPhysicalProperties = PhysicalProperties.new(100, 0.3, 0.5)
        end
    end

    -- Lightweight BodyVelocity for movement + float
    local function setupVelocity()
        if _G.afVelocity then _G.afVelocity:Destroy() end
        _G.afVelocity = Instance.new("BodyVelocity")
        _G.afVelocity.MaxForce = Vector3.new(10000, 5000, 10000)
        _G.afVelocity.Velocity = Vector3.zero
        _G.afVelocity.Parent = torso
    end

    -- WASD movement
    local function handleMovement()
        if _G.afInputConn then _G.afInputConn:Disconnect() end
        _G.afInputConn = game:GetService("UserInputService").InputChanged:Connect(function(input, gp)
            if gp or not _G.afVelocity or not hum or hum:GetState() ~= Enum.HumanoidStateType.Ragdoll then return end
            local moveDir = Vector3.zero
            if input.UserInputType == Enum.UserInputType.Keyboard then
                if input.KeyCode == Enum.KeyCode.W then moveDir += Vector3.new(0, 0, -1) end
                if input.KeyCode == Enum.KeyCode.S then moveDir += Vector3.new(0, 0, 1) end
                if input.KeyCode == Enum.KeyCode.A then moveDir += Vector3.new(-1, 0, 0) end
                if input.KeyCode == Enum.KeyCode.D then moveDir += Vector3.new(1, 0, 0) end
            end
            -- Minimal float + movement
            _G.afVelocity.Velocity = (moveDir * 20) + Vector3.new(0, 2, 0) -- Tiny upward force
        end)
    end

    -- Start on ragdoll
    _G.afRemoteConn = RagdollRemote.OnClientEvent:Connect(function(...)
        local args = {...}
        if args[2] == "manualD" or args[2] == "manualM" then
            task.spawn(function()
                task.wait()
                if hum and hum.Parent then
                    hum:ChangeState(Enum.HumanoidStateType.Ragdoll)
                    setupVelocity()
                    handleMovement()
                end
            end)
        end
    end)

    -- Ensure movement during ragdoll state
    _G.afStateConn = hum.StateChanged:Connect(function(_, new)
        if new == Enum.HumanoidStateType.Ragdoll then
            setupVelocity()
            handleMovement()
        elseif new == Enum.HumanoidStateType.Running or new == Enum.HumanoidStateType.GettingUp then
            if _G.afVelocity then _G.afVelocity:Destroy(); _G.afVelocity = nil end
            if _G.afInputConn then _G.afInputConn:Disconnect(); _G.afInputConn = nil end
        end
    end)

    -- Reapply on character respawn
    player.CharacterAdded:Connect(function(newChar)
        char = newChar
        hum = char:WaitForChild("Humanoid")
        torso = char:FindFirstChild("UpperTorso") or char:WaitForChild("HumanoidRootPart")
        if state then
            for _, part in ipairs(char:GetChildren()) do
                if part:IsA("BasePart") then
                    _G.originalPhysicalProps[part] = part.CustomPhysicalProperties
                    part.CustomPhysicalProperties = PhysicalProperties.new(100, 0.3, 0.5)
                end
            end
        end
    end)
end)


-- === SPAM TOOLS ￢ﾀﾓ BIGGER BUTTON + KEYBIND + CONFIG ===
local player = game.Players.LocalPlayer
local RS = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")

makeBtn("Spam Tools", 3, function(state)
    -- === CLEANUP ===
    if _G.SpamTools then
        if _G.SpamTools.conn then _G.SpamTools.conn:Disconnect() end
        if _G.SpamTools.promptConns then
            for _, c in pairs(_G.SpamTools.promptConns) do
                if c.Connected then c:Disconnect() end
            end
        end
        if _G.SpamTools.highlight then _G.SpamTools.highlight:Destroy() end
        _G.SpamTools = nil
    end

    if not state then return end

    local REUseItem = ReplicatedStorage.Packages.Net["RE/UseItem"]
    local SEQUENCE = {
        {tool = "BeeHive",          args = {}},
        {tool = "Laser Cape",       args = {"position", "UpperTorso"}},
        {tool = "Medusa's Head",    args = {}},
        {tool = "Laser Cape",       args = {"position", "UpperTorso"}},
        {tool = "All Seeing Sentry",args = {}},
        {tool = "Taser Gun",        args = {"UpperTorso"}},
        {tool = "Laser Cape",       args = {"position", "UpperTorso"}},
        {tool = "Bee Launcher",     args = {"player"}}
    }

    _G.SpamTools = {
        enabled = true,
        lastSpam = 0,
        lastSentry = 0,
        lastBoogie = 0,
        promptConns = {},
        currentTarget = nil,
        highlight = nil
    }

    -- === HIGHLIGHT TARGET ===
    local function highlightTarget(target)
        if _G.SpamTools.highlight then _G.SpamTools.highlight:Destroy() end
        if not target or not target.Character then return end
        _G.SpamTools.highlight = Instance.new("Highlight")
        _G.SpamTools.highlight.Adornee = target.Character
        _G.SpamTools.highlight.FillColor = Color3.fromRGB(255, 0, 0)
        _G.SpamTools.highlight.OutlineColor = Color3.fromRGB(255, 100, 100)
        _G.SpamTools.highlight.FillTransparency = 0.5
        _G.SpamTools.highlight.OutlineTransparency = 0
        _G.SpamTools.highlight.Parent = player.PlayerGui
    end

    -- === BRAINROT ANIMATION CHECK ===
    local function hasBrainrotAnimation()
        for _, p in Players:GetPlayers() do
            if p ~= player and p.Character then
                local hum = p.Character:FindFirstChildOfClass("Humanoid")
                if hum and hum:FindFirstChild("Animator") then
                    for _, track in hum.Animator:GetPlayingAnimationTracks() do
                        if track.Animation.AnimationId == "rbxassetid://71186871415348" then
                            return p
                        end
                    end
                end
            end
        end
        return nil
    end

    -- === STOLEN VISIBLE CHECK ===
    local function hasStolenVisible()
        for _, model in Workspace:GetChildren() do
            if model:FindFirstChild("RootPart") then
                local att = model.RootPart:FindFirstChild("Attachment")
                if att then
                    local oh = att:FindFirstChild("AnimalOverhead")
                    if oh then
                        local stolen = oh:FindFirstChild("Stolen")
                        if stolen and stolen:IsA("TextLabel") and stolen.Visible then
                            return true
                        end
                    end
                end
            end
        end
        return false
    end

    -- === BOOGIE BOMB (SPECIAL) ===
    local function useBoogieBomb()
        if tick() - _G.SpamTools.lastBoogie < 1.5 then return end
        local bp = player:FindFirstChild("Backpack")
        local char = player.Character
        if not bp or not char then return end

        local tool = bp:FindFirstChild("Boogie Bomb") or char:FindFirstChild("Boogie Bomb")
        if not tool then return end

        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hum then return end

        hum:EquipTool(tool)
        task.wait(0.15)
        REUseItem:FireServer()
        task.wait(0.1)
        hum:UnequipTools()
        _G.SpamTools.lastBoogie = tick()
    end

    -- === GET TARGET ===
    local function getTarget()
        local animPlayer = hasBrainrotAnimation()
        if animPlayer then
            _G.SpamTools.currentTarget = animPlayer
            highlightTarget(animPlayer)
            return animPlayer
        end

        if hasStolenVisible() then
            for _, model in Workspace:GetChildren() do
                if model:FindFirstChild("RootPart") then
                    local att = model.RootPart:FindFirstChild("Attachment")
                    if att then
                        local oh = att:FindFirstChild("AnimalOverhead")
                        if oh then
                            local stolen = oh:FindFirstChild("Stolen")
                            if stolen and stolen.Visible then
                                local pos = model.RootPart.Position
                                local best, bestD = nil, math.huge
                                for _, p in Players:GetPlayers() do
                                    if p ~= player and p.Character then
                                        local hrp = p.Character:FindFirstChild("HumanoidRootPart")
                                        if hrp then
                                            local d = (hrp.Position - pos).Magnitude
                                            if d < bestD and d < 15 then
                                                bestD = d
                                                best = p
                                            end
                                        end
                                    end
                                end
                                if best then
                                    _G.SpamTools.currentTarget = best
                                    highlightTarget(best)
                                    return best
                                end
                            end
                        end
                    end
                end
            end
        end

        local char = player.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        local best, bestD = nil, math.huge
        for _, p in Players:GetPlayers() do
            if p ~= player and p.Character then
                local tHRP = p.Character:FindFirstChild("HumanoidRootPart")
                if tHRP then
                    local d = (hrp.Position - tHRP.Position).Magnitude
                    if d < bestD then bestD = d; best = p end
                end
            end
        end
        if best and best ~= _G.SpamTools.currentTarget then
            _G.SpamTools.currentTarget = best
            highlightTarget(best)
        end
        return _G.SpamTools.currentTarget
    end

    -- === 9 STUDS CHECK ===
    local function isPlayerInRange()
        local char = player.Character
        if not char then return false end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return false end
        for _, p in Players:GetPlayers() do
            if p ~= player and p.Character then
                local tHRP = p.Character:FindFirstChild("HumanoidRootPart")
                if tHRP then
                    if (hrp.Position - tHRP.Position).Magnitude <= 9 then
                        return true
                    end
                end
            end
        end
        return false
    end

    -- === USE TOOL ===
    local function useTool(toolName, args)
        local bp = player:FindFirstChild("Backpack")
        local char = player.Character
        if not bp or not char then return end

        local tool = bp:FindFirstChild(toolName) or char:FindFirstChild(toolName)
        if not tool then return end

        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hum then return end

        if toolName == "Medusa's Head" and not isPlayerInRange() then return end

        hum:EquipTool(tool)
        if toolName == "Bee Launcher" then
            task.wait(0.5)
        else
            task.wait(0.12)
        end

        local target = getTarget()
        if not target or not target.Character then 
            hum:UnequipTools()
            return 
        end
        local ut = target.Character:FindFirstChild("UpperTorso")
        if not ut then 
            hum:UnequipTools()
            return 
        end
        local pos = ut.Position

        local fireArgs = {}
        for _, a in args do
            if a == "position" then table.insert(fireArgs, Vector3.new(pos.X, pos.Y, pos.Z))
            elseif a == "UpperTorso" then table.insert(fireArgs, ut)
            elseif a == "player" then table.insert(fireArgs, target)
            end
        end

        if #fireArgs > 0 then
            REUseItem:FireServer(unpack(fireArgs))
        else
            REUseItem:FireServer()
        end

        task.wait(0.12)
        hum:UnequipTools()
        task.wait(0.1)
    end

    -- === SENTRY CLEANUP ===
    local function startSentryCleanup()
        Workspace.DescendantAdded:Connect(function(obj)
            if not _G.SpamTools.enabled then return end
            if obj:IsA("BasePart") and obj.Name:match("^Sentry_") then
                if tick() - _G.SpamTools.lastSentry >= 30 then
                    _G.SpamTools.lastSentry = tick()
                    task.defer(obj.Destroy, obj)
                end
            end
        end)
    end

    -- === PROMPT WATCHER ===
    local function watchPrompts()
        _G.SpamTools.promptConns = {}
        for _, obj in ipairs(Workspace:GetDescendants()) do
            if obj:IsA("ProximityPrompt") then
                table.insert(_G.SpamTools.promptConns, obj.Triggered:Connect(function(plr)
                    if plr == player then
                        _G.SpamTools.enabled = false
                        CONFIG.states["Spam Tools"] = false
                        buttons["Spam Tools"].btn.Text = "Spam Tools [OFF]"
                        buttons["Spam Tools"].btn.BackgroundColor3 = buttons["Spam Tools"].off
                        saveConfig()
                    end
                end))
            end
        end
        table.insert(_G.SpamTools.promptConns, Workspace.DescendantAdded:Connect(function(obj)
            if obj:IsA("ProximityPrompt") then
                table.insert(_G.SpamTools.promptConns, obj.Triggered:Connect(function(plr)
                    if plr == player then
                        _G.SpamTools.enabled = false
                        CONFIG.states["Spam Tools"] = false
                        buttons["Spam Tools"].btn.Text = "Spam Tools [OFF]"
                        buttons["Spam Tools"].btn.BackgroundColor3 = buttons["Spam Tools"].off
                        saveConfig()
                    end
                end))
            end
        end))
    end

    -- === SPAM LOOP ===
    local function startSpam()
        _G.SpamTools.conn = RS.Heartbeat:Connect(function()
            if not _G.SpamTools.enabled then return end

            local animPlayer = hasBrainrotAnimation()
            local stolenVisible = hasStolenVisible()
            if animPlayer or stolenVisible then
                useBoogieBomb()
            end

            if tick() - _G.SpamTools.lastSpam >= 1.0 then
                _G.SpamTools.lastSpam = tick()
                task.spawn(function()
                    for _, step in SEQUENCE do
                        if not _G.SpamTools.enabled then break end
                        useTool(step.tool, step.args)
                    end
                end)
            end
        end)
    end

    -- === START EVERYTHING ===
    watchPrompts()
    startSentryCleanup()
    startSpam()

    -- === RESPAWN ===
    player.CharacterAdded:Connect(function()
        task.wait(0.5)
        if _G.SpamTools and _G.SpamTools.enabled then
            watchPrompts()
        end
    end)
end)

-- === OVERRIDE BUTTON SIZE FOR SPAM TOOLS (BIGGER) ===
task.spawn(function()
    repeat task.wait() until buttons["Spam Tools"]
    local frame = buttons["Spam Tools"].btn.Parent
    frame.Size = UDim2.new(1, 0, 0, 50)  -- Bigger height
    buttons["Spam Tools"].btn.Size = UDim2.new(0, 200, 1, 0)  -- Wider button
end)


        -- =====================================================
        -- 8. BORDERS + PARTS (NO LENNON)
        -- =====================================================
        task.spawn(function()
            local map = Workspace:WaitForChild("Map", 15)
            if map then
                local borders = map:FindFirstChild("Borders")
                if borders then borders:Destroy() end
            end

            local function sp(size, cframe, color, transparency)
                local p = Instance.new("Part")
                p.Size = size
                p.CFrame = cframe
                p.Anchored = true
                p.CanCollide = true
                p.Color = color or Color3.fromRGB(255, 0, 0)
                p.Transparency = transparency or 0
                p.Material = Enum.Material.Neon
                p.Parent = Workspace
            end

            sp(Vector3.new(261, 1, 4), CFrame.new(-411, 19.1, -145))
            sp(Vector3.new(3, 1, 412), CFrame.new(-280, 18.3, 58))
            sp(Vector3.new(3, 1, 362), CFrame.new(-541, 18.5, 85))
            sp(Vector3.new(5, 1, 56), CFrame.new(-540, 19, -117))
            sp(Vector3.new(261, 1, 4), CFrame.new(-409, 18.5, 264))

            local brown = Color3.fromRGB(139, 69, 19)
            sp(Vector3.new(7, 1.3, 422), CFrame.new(-286, 15.8, 61), brown, 0.5)
            sp(Vector3.new(254, 1.5, 6), CFrame.new(-416, 16, -139), brown, 0.5)
            sp(Vector3.new(8, 1.3, 493), CFrame.new(-535, 15.9, 42), brown, 0.5)
            sp(Vector3.new(256, 1, 6), CFrame.new(-404, 16, 258), brown, 0.5)
        end)

        print("Mini Hub LOADED - LEFT CORNER - FULLY OPEN - AUTO-EXEC 100%")
    end)
end)
